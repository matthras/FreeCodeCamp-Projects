<!DOCTYPE html>
<meta charset="utf-8">
<style>

.bar {
	fill: blue;
}

.axis {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

</style>

<body>

<script src="d3.js"></script>

<script>

var margin = {top: 20, right: 20, bottom: 30, left: 40},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var x = d3.time.scale()
	.domain([new Date(1947,1,1), new Date(2015,7,1)])
	.range([margin.left, width])

var y = d3.scale.linear()
	.domain([0, 18064.7]) // Move this into json later
	.range([height,0]) // How do I select all columns of data, e.g. data[,0]? 

var xAxis = d3.svg.axis()
	.scale(x)
	.orient('bottom')
	.ticks(d3.time.years, 5);

var yAxis = d3.svg.axis()
	.scale(y)
	.orient('left');

var svg = d3.select("body") // Selects the body element in HTML to attach the chart to
	.append("svg")
		.attr('width', width + margin.left + margin.right)
		.attr('height', height + margin.top + margin.bottom)
	.append('g')
		.attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')')

svg.append('g')
	.attr("transform", "translate(0,"+height+")")
	.call(xAxis);

svg.append('g')
	.attr("transform", "translate(20, 0)")
	.call(yAxis);

var data;

d3.json("barchartdata.json", type, function(error, json) {
	if (error) return console.warn(error);
	data = json.data;

	//x.domain([new Date(json.from_date), new Date(json.to_date)]);




	svg.selectAll(".bar") // Selects all elements ilnked to the CSS class .bar - I have a feeling this needs to be changed.
		.data(data) // Binds 'data' to the 'd' that's used in the functions below
	.enter().append('rect')
		.attr('class','bar')
		.attr("x", function(d) { return d[0]})
		.attr('width', x.range())
		.attr("y", function(d) { return d[1]})
		.attr('height', function(d) { return height-y.range()})
		// Problem: Invalid value for <rect> attribute x = [date] - best guess is that at the moment I don't know how to specify date attributes to the Xaxis == This appears to be fixed?


});

function type(d) {
  d[0] = +d[0];
  return d;
}

</script>
</body>